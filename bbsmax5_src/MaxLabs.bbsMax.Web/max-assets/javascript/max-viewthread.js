var userExtraDatas={},ajaxRequesting=false,showUserExtradata=function(f,e,o){var m=0;m=$(String.format("extradata_{0}_{1}",e,o));if(!m.isProcessed){var n=$("authorinfoInner_"+o);n.style.height=f.offsetHeight+"px";addHandler(n,"mouseover",function(){addCssClass(n,"authorinfo-expand")});addHandler(n,"mouseout",function(){removeCssClass(n,"authorinfo-expand")});addCssClass(n,"authorinfo-expand");m.isProcessed=true;m=window.setTimeout("getExtraDatas("+e+","+o+");",200)}};
function getExtraDatas(f,e){function o(){var a=String.format("panel_{0}_{1}",f,e);if(!$(a)){var b=$("authorExtraTempalte"),c=addElement("div",m);c.id=a;c.className=b.className;var d=b.innerHTML;for(var g in n){a=n[g];if(a instanceof Array){b="<!--{/"+g+"}--\>";var h=d.indexOf("<!--{"+g+"}--\>"),k=d.indexOf(b)+b.length;if(!(h==-1||k==-1||h>k)){b="";var p=d.substr(0,h),j=d.substr(k,d.length-k);d=d.substr(h,k-h);for(h=1;h<=a.length;h++){k=a[h-1];var i=d;for(var l in k){i=i.replace("{"+l+"}",k[l]);i=
i.replace("%7B"+l+"%7D",k[l])}i=i.replace("{_i}",h);b+=i}d=p+b+j}}else d=d.replace("{"+g+"}",a)}c.innerHTML=d}}var m=$(String.format("extradata_{0}_{1}",f,e)),n=userExtraDatas[f.toString()];if(!n&&ajaxRequesting==false){ajaxRequesting=true;addElement("div",m).innerHTML='<div class="ajaxloading"><span>\u52a0\u8f7d\u4e2d...</span></div>';var q=String.format(authorUrl,f,(new Date).getMilliseconds());q=new ajaxWorker(q,"get","");q.addListener(200,function(a){n=eval("("+a+")");userExtraDatas[f.toString()]=
n;m.removeChild(m.childNodes[m.childNodes.length-1]);o();ajaxRequesting=false});q.send()}else ajaxRequesting==false&&o()}var bhtml='\ufeff<div class="imagebrowser-label" id="vLabel" style="display:none;">100%</div><div class="imagebrowser-tools" id="vTopbar" style="display:none;">    <div class="imagebrowser-tools-inner">        <a class="prev" href="javascript:;"  title="\u4e0a\u4e00\u5f20" id="vPrevious" onclick="_IV.previous();">|&lt;</a>        <a class="next" href="javascript:;" title="\u4e0b\u4e00\u5f20" id="vNext" onclick="_IV.next();">&gt;|</a>        <a class="zoomout" href="javascript:;" title="\u7f29\u5c0f" id="Button2" onclick="_IV.zoom(-1);">-</a>        <a class="zoomin" href="javascript:;"  title="\u653e\u5927" id="Button3" onclick="_IV.zoom(1);">+</a>        <a class="original" href="javascript:;" title="\u539f\u59cb\u5c3a\u5bf8" id="Button5" onclick="_IV.originalSize();">1:1</a>        <a class="blank" href="javascript:;"  title="\u65b0\u7a97\u53e3\u6253\u5f00" id="Button1" onclick="_IV.showInWindow();">\u25a1</a>        <a class="close" href="javascript:;"  title="\u5173\u95ed" id="Button4" onclick="_IV.close();">X</a>    </div></div><div class="imagebrowser-nav" id="vToolbar" style="display:none;">    <a class="prev" href="javascript:;" onmousedown="_IV.scroll(-1)" onmouseup="_IV.stopScroll()">&lt;</a>    <div class="imagebrowser-thumbs" id="vScroll">        <div class="imagebrowser-thumbs-inner" id="vList" style="left:0px; position:relative; top:0px;">            <div class="thumblist" id="vListTable"></div>        </div>    </div>    <a class="next" href="javascript:;" onmouseup="_IV.stopScroll()" onmousedown="_IV.scroll(1)">&gt;</a></div>';
document.write(bhtml);
function createImageViewer(){function f(){var a=_IV.scrollFlag,b=parseInt(_IV.list.style.left),c=_IV.list.offsetWidth,d=_IV.listScroll.offsetWidth;if(!(c<d)){if(a==-1){if(b<0)b+=92;if(b>0)b=0}else if(a==1){if(0-b<c-d)b-=92;if(0-b>c-d)b=d-c}_IV.list.style.left=b+"px"}}var e={};e.objectPool={};e.toolbar=$("vToolbar");e.topbar=$("vTopbar");e.container=$("vContainer");e.list=$("vList");e.index=0;e.listScroll=$("vScroll");e.listTable=$("vListTable");e.label={};e.label.object=$("vLabel");e.label.show=function(a){this.seconds=
25;setVisible(this.object,1);this.object.innerHTML=a;opacity(this.object,75);if(!this.visibled){this.visibled=true;var b=new timer(20,function(){var c=_IV.label;c.seconds--;if(c.seconds<=0){b.stop();c.hide()}});b.start();_IV.setPos(this.object)}};e.label.hide=function(){this.seconds=0;this.visibled=false;setVisible(this.object,0)};e.appendImageItem=function(a){var b=a.src;if(!this.imageList)this.imageList={};if(this.imageList[b]==null){this.imageList[b]=1;var c=document.createElement("a");c.index=
a.index;c.href="javascript:;_IV.open('"+a.src+"');";c.innerHTML='<img onload="setVisible(this,true);imageScale(this,80,80);if(this.height<80)this.style.paddingTop=(Math.abs(80-this.height)/2)+\'px\'; " style="display:none;" src="'+b+'" />';a=this.listTable;b=false;for(var d=0;d<a.childNodes.length;d++){var g=a.childNodes[d];if(g.index>c.index){a.insertBefore(c,g);b=true;break}}b==false&&a.appendChild(c);this.list.style.width=a.childNodes.length*90+"px"}};e.showInWindow=function(){this.current&&open(this.current.src)};
e.originalSize=function(){if(this.current){this.image.width=this.current.width;this.image.height=this.current.height;this.setPos(this.body);this.label.show("100%")}};e.scroll=function(a){this.scrollFlag=a;if(this.scrollTimer==null){f();this.scrollTimer=new timer(400,f);this.scrollTimer.start()}};e.stopScroll=function(){if(this.scrollTimer){this.scrollTimer.stop();this.scrollTimer=null}};e.setPosition=function(a){var b=max.global.getBrowserRect(),c=_IV.toolbar,d=c.offsetHeight;b.height-=d;b.bottom-=
d;_IV.mainArea=b;c=c.style;c.top=b.bottom+"px";c.left=b.left+"px";c.width=b.width+"px";c=_IV.topbar;c=c.style;c.top=b.top+"px";c.width="250px";c.left="auto";c.right=0;_IV.listScroll.style.width=b.width*0.9+"px";!a&&_IV.isOpen&&_IV.setPos(_IV.body);_IV.isOpen&&setStyle(_IV.masker,{left:b.left+"px",top:b.top+"px",width:b.width+"px",height:b.height+"px"})};e.isOpen=false;var o=new stringBuilder;for(o=0;o<threadImageCollection.length;o++){var m=threadImageCollection[o],n=m.src;e.appendImageItem(m)}e.next=
function(){if(this.index<threadImageCollection.length-1)this.open(threadImageCollection[this.index+1].src);else this.index==threadImageCollection.length-1&&this.open(threadImageCollection[0].src)};e.previous=function(){if(this.index>0)this.open(threadImageCollection[this.index-1].src);else this.index==0&&this.open(threadImageCollection[threadImageCollection.length-1].src)};e.setPos=function(a){var b=this.mainArea.height,c=a.offsetHeight;a.style.left=this.mainArea.left+(this.mainArea.width-a.offsetWidth)/
2+"px";a.style.top=this.mainArea.top+(b-c)/2+"px"};e.ondrag=function(a){endEvent(a);return false};e.picmousedown=function(a){var b=getLeft(_IV.body),c=getTop(_IV.body),d=window.event||a;_IV.mouseStart={x:a.clientX-b,y:a.clientY-c};_IV.isMoveImage=1;a=_IV.image;max.browser.isIE?a.setCapture():window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)};e.bodymouseup=function(a){a=window.event||a;a=a.srcElement||a.target;_IV.isOpen&&a==_IV.masker&&_IV.close();a=_IV.image;_IV.mouseStart=null;_IV.isMoveImage=
0;max.browser.isIE?a.releaseCapture():window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP)};e.picmousemove=function(a){if(_IV.isMoveImage){a=window.event||a;_IV.mouseStart&&setStyle(_IV.body,{left:a.clientX-_IV.mouseStart.x+"px",top:a.clientY-_IV.mouseStart.y+"px"})}};e.close=function(){setVisible(this.body,0);setVisible(this.toolbar,0);setVisible(this.topbar,0);this.isOpen=false;removeElement(this.masker);this.masker=null;(max.browser.isIE?document.documentElement:document.body).style.overflow="auto";
document.body.onmousewheel=function(){return true};removeHandler(this.image,"mousedown",_IV.picmousedown);removeHandler(document,"mouseup",_IV.bodymouseup);removeHandler(document,"mousemove",_IV.picmousemove);removeHandler(document.body,"resize",_IV.setPosition);this.label.hide()};e.zoom=function(a){setStyle(this.image,{visibility:"hidden"});var b,c,d,g;b=this.image.height;c=this.image.width;g=this.current.height*0.05;d=this.current.width*0.05;var h;if(a<0){g=0-g;d=0-d}a=b+g;d=c+d;g=getLeft(this.body);
h=getTop(this.body);e.close=function(){setVisible(this.body,0);setVisible(this.toolbar,0);setVisible(this.topbar,0);this.isOpen=false;removeElement(this.masker);this.masker=null;(max.browser.isIE?document.documentElement:document.body).style.overflow="auto";document.body.onmousewheel=function(){return true};removeHandler(document.body,"resize",_IV.setPosition);this.body&&removeElement(this.body);this.label.hide()};h+=(b-a)/2;g+=(c-d)/2;if(!(d<30)){b=Math.floor(100*(d/this.current.width))+"%";this.image.width=
d;this.image.height=a;this.body.style.left=g+"px";this.body.style.top=h+"px";this.label.show(b);setStyle(this.image,{visibility:"visible"})}};var q=function(a,b,c){if(max.browser.isIE){if(b){a.style.visibility="hidden";a.style.filter="BlendTrans(duration=.80);"}a.filters[0].Apply();a.style.visibility=b?"visible":"hidden";a.filters[0].play();c&&c()}else{var d=new timer(1,function(g){b>0?opacity(a,g*25):opacity(a,(4-g)*25);if(g>=4){c&&c.call(_IV);d.stop()}});d.start()}};e.open=function(a){function b(){this.image=
this.body=null;this.body=addElement("div");var p=0,j;if(this.objectPool[a]){j=this.objectPool[a];this.body.appendChild(j);p=1}else{j=addElement("img",this.body);this.objectPool[a]=j}setStyle(this.body,{position:"absolute",padding:"5px",zIndex:990,backgroundColor:"White"});c||opacity(this.body,0);for(var i,l,r=0;r<threadImageCollection.length;r++){var s=threadImageCollection[r];if(a==s.src){l=s.height;i=s.width;this.index=r}}this.current=threadImageCollection[this.index];r=this.mainArea.height;var v=
this.mainArea.width;s=i/l;if(i>v*0.9){i=v*0.9;l=i/s}else{i=i;l=l}if(l>r*0.9){l=r*0.9;i=l*s}this.body.onmousewheel=this.label.object.onmousewheel=function(u){var t=0;if(!u)u=window.event;if(u.wheelDelta){t=event.wheelDelta/120;if(window.opera)t=-t}else if(u.detail)t=-u.detail/3;t&&_IV.zoom(t);return false};j.width=i;j.height=l;if(!p)j.src=a;this.image=j;this.setPos(this.body);q(this.body,1);addHandler(j,"mousedown",_IV.picmousedown);addHandler(document,"mouseup",_IV.bodymouseup);addHandler(document,
"mousemove",_IV.picmousemove);addHandler(j,"dragstart",_IV.ondrag);if(!this.isOpen)this.isOpen=true;this.label.hide()}if(!(this.current&&this.current.src==a&&this.isOpen)){var c=max.browser.isIE;if(!this.isOpen){var d=addElement("div"),g=max.global.getBrowserRect();setStyle(d,{position:"absolute",left:g.left+"px",top:g.top+"px",width:g.width+30+"px",height:g.height+"px",backgroundColor:"black",zIndex:49});opacity(d,30);this.masker=d;document.body.onmousewheel=function(){return false};setVisible(this.toolbar,
1);setVisible(this.topbar,1);(max.browser.isIE?document.documentElement:document.body).style.overflow="hidden";addHandler(window,"resize",_IV.setPosition);this.setPosition()}window.setTimeout(function(){for(var p=_IV.listTable.childNodes,j=0;j<p.length;j++){var i=p[j];i.childNodes[0].src==a?addCssClass(i,"current"):removeCssClass(i,"current")}},10);var h=this.body,k=this.image;if(h){d=h.style.zIndex;d--;h.style.zIndex=d;q(h,0,function(){if(k){removeHandler(k,"mousedown",_IV.picmousedown);removeHandler(document,
"mouseup",_IV.bodymouseup);removeHandler(document,"mousemove",_IV.picmousemove);removeHandler(k,"dragstart",_IV.ondrag);k=null}removeElement(h);h=null;b.call(_IV)})}else b.call(_IV)}};return e}function ubbRun(f){f=f.parentNode.parentNode.getElementsByTagName("code")[0].innerHTML;var e=window.open("about:blank");f=f.replace(/&lt;/g,"<");f=f.replace(/&gt;/g,">");f=f.replace(/&amp;/g,"&");e.document.open();e.document.write(f);e.document.close()}
function ubbCopy(f){f=f.parentNode.parentNode.getElementsByTagName("code")[0].innerHTML;f=f.replace(/&lt;/g,"<");f=f.replace(/&gt;/g,">");f=f.replace(/&nbsp;/g," ");f=f.replace(/&amp;/g,"&");copyToClipboard(f)};
