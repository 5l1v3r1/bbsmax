var a;window.root||(root="");if(!window.maxdoc)window.maxdoc=document;var keyEnum={enter:"13",ctrl:"17",space:"32",backspace:"8",shift:"16",esc:"27"};a=String.prototype;a.contains=function(b){return this.indexOf(b)>-1};a.trim=function(b){return b?this.trimEnd(b).trimStart(b):this.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"")};a.trimEnd=function(b){if(this.endsWith(b))return this.substring(0,this.length-b.length);return this};a.trimStart=function(b){if(this.startsWith(b))return this.slice(b.length);return this};
a.startsWith=function(b){return this.indexOf(b)==0};a.endsWith=function(b){return b.length<=this.length&&this.substr(this.length-b.length,b.length)==b};a.remove=function(b,c){var d=this.substring(0,b);b=this.substring(b+c,this.length);return d+b};a.insert=function(b,c){var d=this.substring(0,b);b=this.substring(b,this.length);return d+c+b};a.getHashCode=function(){for(var b=31,c=0,d=this.length;c<d;)b^=(b<<5)+(b>>2)+this.charCodeAt(c++);return b};String.isNullOrEmpty=function(b){return b};
String.format=function(){for(var b=arguments[0],c=1;c<arguments.length;c++)b=b.replace(new RegExp("\\{"+(c-1)+"\\}","ig"),arguments[c]);return b};Array.prototype.contains=function(b){for(var c=0;c<this.length;c++)if(b==this[c])return true;return false};
var stringBuilder=function(b){this.arr=[];this.length=0;if(b){this.arr.push(b);this.length+=b.length}if(!stringBuilder.created){stringBuilder.prototype.append=function(c){this.arr.push(c);this.length+=c.length;return this};stringBuilder.prototype.clear=function(){this.arr.splice(0,this.arr.length);this.length=0;return this};stringBuilder.created=true}},max={browser:{isIE:navigator.userAgent.toLowerCase().contains("msie"),isIE5:navigator.userAgent.toLowerCase().contains("msie 5"),isIE6:navigator.userAgent.toLowerCase().contains("msie 6"),
isIE7:navigator.userAgent.toLowerCase().contains("msie 7"),isGecko:navigator.userAgent.toLowerCase().contains("gecko"),isSafari:navigator.userAgent.toLowerCase().contains("safari"),isOpera:navigator.userAgent.toLowerCase().contains("opera")},global:{getClientWidth:function(){return maxdoc.documentElement&&maxdoc.documentElement.clientWidth||maxdoc.body.clientWidth},getClientHeight:function(){return maxdoc.documentElement&&maxdoc.documentElement.clientHeight||maxdoc.body.clientHeight},getScrollTop:function(){return maxdoc.documentElement&&
maxdoc.documentElement.scrollTop||maxdoc.body.scrollTop},getScrollLeft:function(){return maxdoc.documentElement&&maxdoc.documentElement.scrollLeft||maxdoc.body.scrollLeft},getFullHeight:function(){return maxdoc.documentElement.clientHeight>maxdoc.documentElement.scrollHeight?maxdoc.documentElement.clientHeight:maxdoc.documentElement.scrollHeight},getFullWidth:function(){return maxdoc.documentElement.scrollWidth},getBrowserRect:function(){var b={};b.left=this.getScrollLeft();b.top=this.getScrollTop();
b.width=this.getClientWidth();b.height=this.getClientHeight();b.bottom=b.top+b.height;b.right=b.left+b.width;return b}},coor:{left:function(b,c){if(typeof c=="number"){b.style.position="absolute";b.style.left=c+"px"}else{c=b.offsetLeft;if(b.offsetParent!=null)c+=Left(b.offsetParent);return c}},top:function(b,c){if(typeof c=="number"){b.style.position="absolute";b.style.top=c+"px"}else{c=b.offsetTop;if(b.offsetParent!=null)c+=Top(b.offsetParent);return c}},width:function(b,c){if(typeof c=="number")b.style.width=
c+"px";else return b.offsetWidth},height:function(b,c){if(typeof c=="number")b.style.height=c+"px";else return b.offsetHeight},getRect:function(b){var c={};c.left=getLeft(b);c.top=getTop(b);c.width=getWidth(b);c.height=getHeight(b);c.bottom=c.top+c.height;c.right=c.left+c.width;return c}},consts:{loading16:root+"/max-assets/images/loading_16.gif",loading32:root+"/max-assets/images/loading.gif"},eval:function(b){if(b)return max.browser.isIE?execScript(b):window.eval(b)}};
function $(b){return typeof b=="string"?maxdoc.getElementById(b):b}function $$(b){return typeof b=="string"?maxdoc.getElementsByName(b):null}function $T(b){return typeof b=="string"?maxdoc.getElementsByTagName(b):null}function setStyle(b,c){for(var d in c)b.style[d]=c[d]}function addCssClass(b,c){if(b.className)b.className.indexOf(c)>-1||(b.className+=" "+c);else b.className=c}
function removeCssClass(b,c){var d=b.className;if(d){var e=d.indexOf(c);if(e!=-1){if(d.length==c.length)d="";else if(e==0)d=d.remove(0,c.length).trim();else if(e>0)d=d.remove(e,c.length).trim().replace("  "," ");b.className=d}}}function addElement(b,c){b=maxdoc.createElement(b);typeof c!="undefined"?c.appendChild(b):maxdoc.body.appendChild(b);return b}function getFileSize(b){for(var c=0;b>1024;){c++;b/=1024}b=parseFloat(b).toFixed(2);return b+["B","KB","MB","GB","TB"][c]}
function removeElement(b){if(typeof b=="string")b=$(b);b.parentNode.removeChild(b)}function attr(b,c,d){if(d)b.setAttribute(c,d);else return b.getAttribute(c)}var endEvent=function(b){if(max.browser.isIE){if(event){event.cancelBubble=true;event.returnValue=false}}else{b.preventDefault();b.stopPropagation()}return false};function addHandler(b,c,d){if(c.indexOf("on",0)==0)c=c.substring(2,c.length);max.browser.isIE?b.attachEvent("on"+c,d):b.addEventListener(c,d,false)}
function HTMLEncode(b){var c=maxdoc.createElement("div");c.textContent!=null?(c.textContent=b):(c.innerText=b);return c.innerHTML}function refresh(){var b=location.href;if(b.indexOf("#",0)>-1)b=b.substring(0,b.indexOf("#",0));location.replace(b)}function writeCookie(b,c,d){var e="";if(d){e=new Date((new Date).getTime()+d*36E5);e="; expires="+e.toGMTString()}maxdoc.cookie=b+"="+escape(c)+e}
function readCookie(b){var c="";b=b+"=";if(maxdoc.cookie.length>0){offset=maxdoc.cookie.indexOf(b);if(offset!=-1){offset+=b.length;end=maxdoc.cookie.indexOf(";",offset);if(end==-1)end=maxdoc.cookie.length;c=unescape(maxdoc.cookie.substring(offset,end))}}return c}function setVisible(b,c){b.style.display=c?"":"none"}function opacity(b,c){if(max.browser.isIE)b.style.filter="alpha(opacity="+c+")";else setStyle(b,{opacity:c/100,MozOpacity:c/100,KhtmlOpacity:c/100,filter:"alpha(opacity="+c+")"})}
function removeHandler(b,c,d){if(c.indexOf("on",0)>=0)c=c.substring(2,c.length);max.browser.isIE?b.detachEvent("on"+c,d):b.removeEventListener(c,d,false)}function isUndefined(b){return typeof b=="undefined"?true:false}function getTop(b){var c=b.offsetTop;if(b.offsetParent!=null)c+=getTop(b.offsetParent);return c}function getLeft(b){var c=b.offsetLeft;if(b.offsetParent!=null)c+=getLeft(b.offsetParent);return c}function getWidth(b){return b.offsetWidth}function getHeight(b){return b.offsetHeight}
function getRect(b){var c={};c.left=getLeft(b);c.top=getTop(b);c.width=getWidth(b);c.height=getHeight(b);c.bottom=c.top+c.height;c.right=c.left+c.width;return c}function onEnterSubmit(b,c){addHandler($(b),"keydown",function(d){if((d=d||window.event)&&(d.keyCode==13||d.which==13)){for(d=d.target||d.srcElement;d&&d.nodeName.toLowerCase()!="form";)d=d.parentNode;c?clickButton(c,d.id):d.submit();return false}})}
function onCtrlEnter(b,c){for(var d=typeof b!="object"?$(b):b;d&&d.nodeName.toLowerCase()!="form";)d=d.parentNode;if(d){addHandler(d,"mouseover",function(){d.focus=1});addHandler(d,"mouseout",function(){d.focus=0});addHandler(d,"keydown",function(e){e=e||window.event;if(d.focus)if(e&&(e.keyCode==13||e.which==13)&&e.ctrlKey)c(e)})}}
var attachQuery=function(b,c,d){var e=new RegExp("(\\?|&)"+c+"=.*?(&|$)","ig");if(e.test(b))b=b.replace(e,"$1"+c+"="+escape(d)+"$2");else{e=b.indexOf("?")>-1?"&":"?";b+=e+c+"="+escape(d)}return b},moveToCenter=function(b){var c=getRect(b),d=max.global.getBrowserRect();setVisible(b,true);var e=d.top+(d.height-c.height)/2;c=d.left+(d.width-c.width)/2;if(b.style.position=="fixed"){e-=d.top;c-=d.left}setStyle(b,{left:c+"px",top:e+"px"})},maxDragObject=function(b,c){function d(g){g=g||window.event;if(b.drag){b.drag=
0;if(max.browser.isIE)f.releaseCapture();else{window.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);g.preventDefault()}document.body.onselectstart=null}}function e(g){if(b.drag){g=g||window.event;setStyle(b,{left:g.clientX-b._x+"px",top:g.clientY-b._y+"px"})}}function h(g){g=g||window.event;if(max.browser.isIE)f.setCapture();else{window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);g.preventDefault()}var i=getLeft(b),j=getTop(b);b._x=g.clientX-i;b._y=g.clientY-j;b.drag=1;document.body.onselectstart=
function(){return false}}var f=c||b;addHandler(f,"mousedown",h);if(!max.browser.isIE)f=f=document.body;addHandler(f,"mousemove",e);addHandler(f,"mouseup",d)},showPopup=function(b,c,d,e,h){d||(d="auto");var f=b.style;f.display="";var g;rt=max.coor.getRect(c);rl=max.coor.getRect(b);rw=max.global.getBrowserRect();b=rt.bottom+rl.height<rw.bottom?rt.bottom:rw.bottom-rt.bottom>rt.top-rw.top?rt.bottom:rt.top-rl.height;g=rt.left+rl.width>rw.right?rt.right-rl.width:rt.left;if(d.indexOf("left")>-1)g=rt.left;
else if(d.indexOf("right")>-1)g=rt.right-rl.width;else if(d.indexOf("center")>-1)g=rt.left+rt.width/2-rl.width/2;if(d.indexOf("top")>-1)b=rt.top-rl.height;else if(d.indexOf("bottom")>-1)b=rt.bottom;if(c.style.position=="fixed"){g+=rw.left;b+=rw.top}if(e)g+=e;if(h)b+=h;f.left=g+"px";f.top=b+"px"},timer=function(b,c){this.counter=0;this.interval=b;this.ontick=c;this.handler=null};timer.prototype.start=function(){var b=this;this.handler=window.setInterval(function(){b.ontick(++b.counter)},this.interval)};
timer.prototype.stop=function(){window.clearInterval(this.handler);this.interval=0};
var checkboxList=function(b,c,d){function e(){if(i)if(j.length){for(var l=true,o=0;o<j.length;o++)if(j[o].checked!=true){l=false;break}i.checked=l}}function h(){for(var l=0;l<j.length;l++){j[l].checked=i.checked;this.onSelectAllCallItemChange&&f(j[l])}}function f(l){k&&k(l)}function g(l){function o(p){t=(max.browser.isIE?window.event.keyCode:p.which)==keyEnum.shift}function r(){t=false}function v(){if(t==true){s=-1;for(var p=0;p<j.length;p++)if(j[p].checked==true){if(s==-1)s=p;u=p}if(s>-1)for(p=s;p<=
u;p++){j[p].checked=true;f(j[p])}e()}}var s,u,t=false;l=l?$(l):maxdoc.documentElement;addHandler(l,"click",v);addHandler(l,"keydown",o);addHandler(l,"keyup",r)}var i,j,k;this.onSelectAllCallItemChange=true;if(b instanceof Array){j=[];for(var m,n=0;n<b.length;n++){m=$$(b[n]);for(var q=0;q<m.length;q++)j.push(m[q])}}else j=$$(b);if(c){i=$(c);i!=null&&addHandler(i,"click",h)}for(n=0;n<j.length;n++)addHandler(j[n],"click",function(l){i&&e();f(max.browser.isIE?window.event.srcElement:l.target)});g(d);
return{selectedList:function(){var l,o=0;l=[];for(var r=0;r<j.length;r++)if(j[r].checked){l[o]=j[r].value;o++}return l},selectCount:function(){for(var l=0,o=0;o<j.length;o++)j[o].checked&&l++;return l},reverse:function(){for(var l=0;l<j.length;l++){j[l].checked=!j[l].checked;f(j[l])}e()},selectAll:function(){for(var l=0;l<j.length;l++){j[l].checked=true;f(j[l])}e()},SetItemChangeHandler:function(l){k=l}}};
function findElement(b,c){var d;b=$T(b);d=[];for(var e=0;e<b.length;e++)b[e].id&&b[e].id.indexOf(c,0)>=0&&d.push(b[e]);return d}function imageScale(b,c,d){var e=b.width,h=b.height,f=e/h;if(c&&e>c){b.width=c;b.height=c/f}if(d&&h>d){b.height=d;b.width=d*f}if(c&&d)if(b.width>c)imageScale(b,c);else b.height>d&&imageScale(b,0,d)}
function hasQuery(b){if(b.contains("/?")){var c=b.toString().indexOf("/?");return b.toString().indexOf("?",c+2)!=-1}c=b.toLowerCase();if(c.contains("/default.aspx?")){c=c.toString().indexOf("/default.aspx?");return b.toString().indexOf("?",c+14)!=-1}else if(c.contains("/index.aspx?")){c=c.toString().indexOf("/index.aspx?");return b.toString().indexOf("?",c+12)!=-1}else return b.contains("?")}
function ctrlEnterEvent(b,c,d){for(var e=1;e<arguments.length;e++){var h=maxdoc.getElementById(arguments[e]);if(h)h.onkeydown=function(f){f=f||window.event;f.ctrlKey&&f.keyCode==13&&b&&b()}}}var execInnerJavascript=function(b){for(var c=/<script[^>]*?>((?:.|\n|\r)*?)<\/script>/ig,d=/<!--\{js(?:\s|\n)((?:.|\n|\r)+?)\}--\>/ig,e;e=c.exec(b);)max.eval(e[1]);for(;e=d.exec(b);)max.eval(e[1])};
function to16(b){function c(e){switch(e){case 0:return"0";case 1:return"1";case 2:return"2";case 3:return"3";case 4:return"4";case 5:return"5";case 6:return"6";case 7:return"7";case 8:return"8";case 9:return"9";case 10:return"A";case 11:return"B";case 12:return"C";case 13:return"D";case 14:return"E";case 15:return"F"}}b=b;if(isNaN(b))return 0;else{for(var d="";b>=16;){d=c(b%16)+d;b=parseInt(b/16)}return d=c(b%16)+d}}var proxyUrl="/httpproxy.aspx";
ajaxWorker=function(b,c,d){this.r=null;this.url=proxyUrl+"?url="+encodeURI(b);this.method=c;this.content=d;this.header={};this.header.Connection="close";this.header["Content-type"]="application/x-www-form-urlencoded";this.header["If-Modified-Since"]="0";var e=this;if(window.XMLHttpRequest)this.r=new XMLHttpRequest;else if(window.ActiveXObject)try{this.r=new ActiveXObject("Msxml2.XMLHTTP")}catch(h){try{this.r=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){}}this.addListener=function(g,i){if(!this.L)this.L=
[];this.L[g]=i;return this};this.setHeader=function(g,i){this.header[g]=i;this.r.setRequestHeader(g,i);return this};this.send=function(g){if(this.method!="post"&&this.method!="get")this.method="get";this.r.open(this.method,g?g:this.url,true);for(var i in this.header)this.r.setRequestHeader(i,this.header[i]);this.r.send(this.content)};if(this.r)this.r.onreadystatechange=function(){e.r.readyState==4&&e.L[e.r.status]!=null&&e.L[e.r.status](e.r.responseText)}};
getFormData=function(b,c){for(var d={},e=0,h=b.elements.length;e<h;e++){var f=b.elements[e],g=f.name;if(!f.disabled){d[g]||(d[g]=[]);switch(f.tagName.toLowerCase()){case "input":switch(f.type){case "text":case "hidden":case "password":d[g].push(f.value);case "radio":case "checkbox":f.checked&&d[g].push(f.value);break}break;case "textarea":d[g].push(f.value);break;case "select":d[g].push(f.options[f.selectedIndex].value);break}}}if(c){d[c]||(d[c]=[]);d[c].push("")}b="";for(f in d){e=0;for(h=d[f].length;e<
h;e++){if(b!="")b+="&";b+=f+"="+encodeURIComponent(d[f][e])}}return b};ajaxPostData=function(b,c,d){(new ajaxWorker(b,"post",c)).addListener(200,function(e){d&&d(e)}).send()};function ajaxRequest(b,c){b=new ajaxWorker(b,"GET");b.addListener(200,function(d){c&&c(d)});b.send()}ajaxPostForm=function(b,c,d,e){b=$(b);c=c||b.action||location.href;if(!b)return true;d=getFormData(b,d);ajaxPostData(c,d,e)};
ajaxSubmit=function(b,c,d,e,h,f){h=$(b);b=h.action||location.href;if(!d||d=="")d="*";if(d!=null)b+=hasQuery(b)?"&_max_ajaxids_="+d:"?_max_ajaxids_="+d;if(!h)return true;c=getFormData(h,c);(new ajaxWorker(b,"post",c)).addListener(200,function(g){var i=popupCollection.innerList;if(i)for(var j=0;j<i.length;j++)i[j].hide();if(!f)if(e)e(g);else return;i={};for(var k=0;;){j=g.indexOf("|",k);if(j<=k)break;var m=g.substring(k,j);k=j+1;var n=g.indexOf("|",k);if(n<=k)break;k=parseInt(g.substring(k,n));j=g.substr(n+
1,k);k=n+k+2;i[m]=j;if(k>=g.length)break}g=null;for(m in i)if(m=="_max_ajaxresult_")g=eval("("+i[m]+")");else{k=maxdoc.getElementById(m);k.onUpdate&&k.onUpdate(k);j=i[m];k.innerHTML=j;execInnerJavascript(j)}e!=null&&e(g)}).send();return false};
ajaxRender=function(b,c,d){if(!b||b=="")b=location.href;if(!c||c=="")c="*";var e="";if(b.indexOf("#")>-1){var h=b.indexOf("#");e=b.substr(h,b.length-h);b=b.substr(0,h)}b+=hasQuery(b)?"&_max_ajaxids_="+c+"&_random_query_id_="+(new Date).getMilliseconds():"?_max_ajaxids_="+c+"&_random_query_id_="+(new Date).getMilliseconds();b+=e;(new ajaxWorker(b)).addListener(200,function(f){for(var g={},i=0;;){var j=f.indexOf("|",i);if(j<=i)break;var k=f.substring(i,j);i=j+1;var m=f.indexOf("|",i);if(m<=i)break;
i=parseInt(f.substring(i,m));j=f.substr(m+1,i);i=m+i+2;g[k]=j;if(i>=f.length)break}f=null;for(k in g)if(k=="_max_ajaxresult_")f=eval("("+g[k]+")");else{i=$(k);j=g[k];if(i){i.onUpdate&&i.onUpdate(i);i.innerHTML=j}execInnerJavascript(j)}d!=null&&d(f)}).send();return false};var popupCollection=function(){var b=popupCollection;if(!b.innerList)b.innerList=[]};popupCollection.prototype.add=function(b){b.onShow=this.onshow;popupCollection.innerList.push(b)};
popupCollection.prototype.onshow=function(b){for(var c=popupCollection,d=0;d<c.innerList.length;d++)c.innerList[d]!=b&&c.innerList[d].hide()};popupCollection.instance=function(){if(!window.dropCollection)window.dropCollection=new popupCollection;return window.dropCollection};var popupBase=function(b,c,d){this.triggers=[];this.list=typeof b=="object"?b:$(b);this.auto=d;if(c instanceof Array)for(b=0;b<c.length;b++)this.triggers.push($(c[b]));else c instanceof Object?this.triggers.push(c):this.triggers.push($(c))};
popupBase.prototype.show=null;popupBase.prototype.hide=null;popupBase.prototype.onShow=null;popupBase.prototype.onHide=null;
var popup=function(b,c,d,e,h){this.focus=false;popupBase.call(this,b,c,d);this.triggerStyle=e;this.position=h?h:"auto";var f=this;b=this.list.style;b.position="absolute";b.zIndex=50;for(b=0;b<this.triggers.length;b++){c=this.triggers[b];addHandler(c,this.auto?"mouseover":"click",function(g){f.show(g)});if(this.auto)addHandler(c,"mouseout",function(){f.hideList()});else{addHandler(c,"mouseout",function(){f.focus=false});addHandler(c,"mouseover",function(){f.focus=true})}}if(this.auto){addHandler(this.list,
"mouseover",function(){f.focus=true});addHandler(this.list,"mouseout",function(){f.hideList()})}else{addHandler(this.list,"mouseout",function(){f.focus=false});addHandler(this.list,"mouseover",function(){f.focus=true});addHandler(maxdoc.documentElement,"click",function(g){f.focus==false&&f.hide(g)})}popupCollection.instance().add(this)};popup.prototype.hideList=function(){var b=this;setTimeout(function(){b.focus==false&&b.hide()},1E3);b.focus=false};
popup.prototype.show=function(b){b=(b=b||window.event)?b.target?b.target:b.srcElement:this.triggers[0];for(var c=false;b&&this.triggers.length;){for(var d=0;d<this.triggers.length;d++){var e=this.triggers[d];if(b.id)if(e==b||e.id==b.id){b=e;c=true;break}}if(c)break;b=b.parentNode}if(!(this.triggers.length&&!c)){showPopup(this.list,b,this.position);this.focus=true;if(c=this.triggerStyle){addCssClass(b,c);this.cssNode=b}this.onShow&&this.onShow.call(popupCollection.instance(),this)}};
popup.prototype.hide=function(){this.list.style.display="none";var b=this.triggerStyle;b&&this.cssNode&&removeCssClass(this.cssNode,b);this.onHide&&this.onHide.call(popupCollection.instance(),this)};
var background=function(){var b=function(){var g=max.global;if(c){c.style.height=g.getFullHeight()+"px";c.style.width=g.getFullWidth()+"px"}},c,d=false;c=addElement("div");setStyle(c,{backgroundColor:"black",position:"absolute",top:"0px",left:"0px",zIndex:50});opacity(c,30);addHandler(window,"resize",b);if(max.browser.isIE6){var e;e=$T("select");if(e.length>0){d=[];for(var h,f=0;f<e.length;f++){h=e[f];if(h.style.display!="none"&&h.style.visibility!="hidden"){d.push(h);h.style.visibility="hidden"}}}e=
null}b();return{destroy:function(){removeHandler(document,"resize",b);if(d){for(var g=0;g<d.length;g++)d[g].style.visibility="";d=null}removeElement(c);c=null}}};function clickButton(b,c){var d=c?$(c):document.forms[0];c=addElement("input",d);c.style.display="none";c.name=b;c.value="1";d.submit()}
function announcement(b){function c(){if(d.scrollTop%h||g){d.scrollTop++;d.scrollTop%=d.scrollHeight>>1}setTimeout(function(){c()},d.scrollTop%h?10:2E3)}var d=$(b);b=0;var e=d.innerHTML,h=0,f=d.getElementsByTagName("li");b=f.length;var g=1;d.onmouseover=function(){g=0};d.onmouseout=function(){g=1};addHandler(window,"load",function(){h+=f[0].offsetHeight;setStyle(d,{height:h+"px",overflow:"hidden"});d.innerHTML+=e;c()})}
function initDisplay(b,c){var d="";_display=function(e,h){for(var f=document.getElementsByName(e),g=0;g<f.length;g++){var i=f[g];if(i.nodeName=="SELECT"){d=i.value;i.onchange=function(){_display(e,h)}}else if(i.nodeName=="INPUT"&&i.getAttribute("type")=="radio"){if(i.checked)d=i.value;i.onclick=function(){_display(e,h)}}}d=d.toLowerCase();for(g=0;g<h.length;g++){f=h[g];if(f.value.toLowerCase()==d)if(typeof f.id=="string")$(f.id).style.display=f.display?"":"none";else for(i=0;i<f.id.length;i++)$(f.id[i]).style.display=
f.display?"":"none"}if(max.browser.isIE6)if(pageLoadComplete)for(var j in maxPanelManager)if((f=maxPanelManager[j])&&f.panel.frame){g=f.panel.frame;f=getRect(f.panel);setStyle(g,{left:f.left+5+"px",top:f.top+5+"px",width:f.width-10+"px",height:f.height-10+"px"})}};pageLoadComplete?_display(b,c):addPageEndEvent(function(){_display(b,c)})}function showAlert(b){alert(b)}function showSuccess(b){alert(b)}ajaxCallback=function(b){if(b!=null)if(b.iswarning)showAlert(b.message);else b.issuccess&&showSuccess(b.message)};
ajaxCallbackLocationError=function(b){if(b!=null)if(b.iswarning)showAlert(b.message);else b.issuccess&&showSuccess(b.message);else location.href="#errormsg"};function maxConfirm(b,c,d,e){if(confirm(c)){d();return true}else return false}function textCounter(b,c,d){var e=d-b.value.length;if(e<0){b.value=b.value.substr(0,d);e=0}document.getElementById(c).innerHTML=e}
function openDialog(){var b=arguments;if(b.length<1)return true;var c;if(typeof b[0]=="string"){c={src:b[0]};if(b.length==2)if(typeof b[1]=="function")c.return_handler=b[1];else{if(typeof b[1]=="object")c.trigger=b[1]}else if(b.length==3)if(typeof b[1]=="function"){c.return_handler=b[1];c.trigger=b[2]}else{c.return_handler=b[2];c.trigger=b[1]}}else c=b[0];b=c.src;if(b.indexOf("#")>-1){var d=b.indexOf("#");temp=b.substr(d,b.length-d);b=b.substr(0,d)}var e=new ajaxPanel(b,c.trigger,c.return_handler);
e.waiting();e.relocation();e.loadPage();window.setTimeout(function(){e.focus()},20);return false}
function postToDialog(b){var c,d,e;c=b.formId;d=b.url;b=b.callback;e=c?$(c):document.forms[0];if(!e.id)e.id="bbsmax_default_form";if(d.startsWith("?"))d="default.aspx"+d;else if(d.toLowerCase().startsWith(root.toLowerCase()+"/?"))d=root+"/default.aspx"+d.substr(root.length+1);if(typeof d=="undefined")d=e.action;c=getFormData($(c),null);d=new ajaxPanel(d,null,b);d.waiting();d.relocation();d.postToPage(null,c);d.focus();return false}
function loadScript(b,c,d){var e=$T("head")[0],h=e.getElementsByTagName("script");if(h&&h.length>0)for(var f=0;f<h.length;f++)if(h[f]._src&&h[f]._src==b){d&&d();return}var g=document.createElement("script");g.type="text/javascript";g._src=b;g.src=b;if(c)g.charset=c;if(d)if(max.browser.isIE)g.onreadystatechange=function(){if("complete"==g.readyState||g.readyState=="loaded")d&&d()};else g.onload=function(){d&&d()};e.appendChild(g)}var maxPanelManager={},maxPanelCore=function(){};a=maxPanelCore.prototype;
a.resize=function(b,c){this.width=b;this.height=c;setStyle(this.panel,{width:b+"px",height:c+"px"})};a.relocation=function(){this.trigger?showPopup(this.panel,this.trigger,this.position,this.offsetLeft,this.offsetTop):moveToCenter(this.panel);if(max.browser.isIE6)if(this.panel.frame){var b=this.panel.frame,c=getRect(this.panel);setStyle(b,{left:c.left+5+"px",top:c.top+5+"px",width:c.width-10+"px",height:c.height-10+"px"})}};a.submit=function(b){this.postToPage(null,getFormData(this.forms[0],b))};
a.setContent=function(b){this.forms=[];window.currentPanel=this;window.dialog=this;var c=this.panel,d=b.indexOf("<body>");if(d==-1)d=b.indexOf("<body ");if(d>-1){b=b.substr(d,b.length-d);d=b.indexOf(">")+1;b=b.substr(d,b.length-d)}d=b.indexOf("</body>");if(d>-1)b=b.substr(0,d);d=/<script\s[^>]*?src="([^"]+?)"[^>]*?>\s*<\/script>/ig;for(var e;e=d.exec(b);)loadScript(e[1]);c.body.innerHTML=b;d=["input","button"];e=0;for(var h=(new Date).getMilliseconds().toString(),f=0,g=0;g<d.length;g++){var i=c.getElementsByTagName(d[g]);
if(i&&i.length)for(var j=0;j<i.length;j++){var k=i[j];if(k.type=="submit"){if(e==0){var m=k.parentNode,n=0;do{n++;if(b>20){m=null;break}if(m.tagName.toLowerCase()=="form")break}while(m=m.parentNode);if(m==null)continue;h=c.id+"_form_"+e;m.id=h;this.forms.push(m);e++}if(!k.id)k.id=String.format("max_submit_{0}",j);var q=k.id;if(e>0){n=String.format('var e = arguments.length > 0 ? arguments[0] : event;var p=maxPanelManager["{0}"];  var t = e.srcElement || e.target;',this.panelID);var l=String.format('if(p.onSubmit){ if(!p.onSubmit("{0}")){ return false; }  } document.forms["{0}"].onkeypress=null; ajaxPostForm("{0}",null, "{1}", function(r) { var p=maxPanelManager["{2}"];if(p)p.setContent(r); });  endEvent(e); return false;',
h,k.name,this.panelID);q=String.format(n+'t=$("'+q+'"); if(t.disabled) return false; t.disabled="disabled";addCssClass(t,"button-disable"); p.panel.style.cursor="wait";'+l);if(f==0){m.defaultButton=k;if(max.browser.isIE||max.browser.isSafari){m.onsubmit=function(o){endEvent(o);return false};m.onkeypress=new Function(n+' if (e.keyCode!=13)return true;  var tn = t.tagName.toLowerCase(); if(tn!="input" && tn!="select") return; '+String.format(" var f = document.forms['{0}'];  if(!f.defaultButton || f.defaultButton.disabled) return; f.onkeypress=null;",
h)+'p.panel.style.cursor="wait";'+l)}}addHandler(k,"click",new Function(q))}f++}}}if(this.useAjaxLink){c=c.body.getElementsByTagName("a");for(m=0;m<c.length;m++){d=c[m];if(!d.target){e=d.href;if(e.indexOf("/max-dialogs/")!=-1)if(!(e.indexOf("javascript:")>-1))if(!(e.indexOf("#")>-1))if(!d.onclick){if(e.indexOf("isdialog=1")==-1)e+=(hasQuery(e)?"&":"?")+"isdialog=1";d.href="javascript:void(panel.loadPage('"+e+"'))"}}}}this.hasContent||this.relocation();this.hasContent=1;execInnerJavascript(b);this.panel.style.cursor=
"default";window.currentPanel=null};a.waiting=function(){this.setContent(String.format('<div class="dialogloader"><span>\u6b63\u5728\u8f7d\u5165...</span></div>',max.consts.loading16));this.hasContent=0};a.loadPage=function(b){var c=this;ajaxRequest(b||this.url,function(d){c.setContent(d)});return false};a.postToPage=function(b,c){var d=this;ajaxPostData(b||this.url,c,function(e){d.setContent(e)})};
a.close=function(){if(window.panel==this)window.panel=null;if(max.browser.isIE6)if(this.panel.frame)try{removeElement(this.panel.frame)}catch(b){}this.panel.style.display="none";window.setTimeout(String.format("delete maxPanelManager['{0}']; try{ removeElement($('{0}'))}catch(e){};",this.panelID),50);this.closeCallback&&this.result&&this.closeCallback(this.result);this.onclick&&this.onclick(this.panelID);if(this.closeHandlers)for(var c=0;c<this.closeHandlers.length;c++)this.closeHandlers[c](this.panelID);
return false};a.show=function(){this.panel.style.display=""};a.addCloseHandler=function(b){if(!this.closeHandlers)this.closeHandlers=[];this.closeHandlers.push(b)};a.focus=function(){window.panel=this;window.dialog=this;for(var b in maxPanelManager){var c=maxPanelManager[b];if(c.panelID!=this.panelID)c.panel.style.zIndex=50}this.panel.style.zIndex=51};
var maxPanel=function(b){var c=0;if(maxPanelManager[b.id])c=1;var d=b.trigger,e=b.w,h=b.h,f=b.position,g=b.cssClass,i=b.innerCssClass,j=b.bodyCssClass;if(c){c=maxPanelManager[b.id].panel;c.isOld=1}else{c=addElement("div",document.body);c.id=b.id;c.onclick=function(){window.isClickDialog=1};(c.className=g)&&addCssClass(c,g);c.inner=addElement("div",c);c.inner.className=i;c.body=addElement("div",c.inner);if(j)c.body.className=j;addHandler(c,"mouseover",new Function(String.format('var p=maxPanelManager["{0}"]; window.panel=p; p.isFocus=1;        window.dialog = window.panel;',
b.id)));addHandler(c,"mouseout",new Function(String.format('maxPanelManager["{0}"].isFocus=0;',b.id)));addHandler(c,"mousedown",new Function(String.format('maxPanelManager["{0}"].focus();',b.id)));g="absolute";if(!d&&!max.browser.isIE6)g="fixed";setStyle(c,{position:g,zIndex:50});maxPanelManager[b.id]=this;if(max.browser.isIE6){g=document.createElement("iframe");setStyle(g,{position:"absolute",left:"-0px",top:"-0px",height:"1px",width:"1px",zIndex:1});g.frameBorder="0";document.body.appendChild(g);
c.frame=g}}if(e){c.inner.style.width=e+"px";this.width=e}if(h){c.inner.style.height=h+"px";this.height=h}this.panelID=b.id;this.trigger=d;this.position=f;this.panel=c};maxPanel.prototype=new maxPanelCore;
function ajaxPanel(b,c,d){var e=root+"/max-dialogs/",h=0;h="";var f=-1;h=b.toLowerCase();if(h.indexOf("http://")>-1){h=h.substr(h.indexOf("http://")+7);h=h.substr(h.indexOf("/"))}h=h.substr(e.length);if(h.indexOf("/")>-1)h=h.substr(0,h.indexOf("/")).getHashCode();else{f=h.indexOf("/?")>-1?h.indexOf("?",h.indexOf("/?")+2):h.indexOf("?");h=f==-1?h:h.substr(0,f);h=h.getHashCode()}if(h==0)h=b.getHashCode();b+=hasQuery(b)?"&isdialog=1":"?isdialog=1";this.url=b;maxPanel.call(this,{id:"mx_dialog_"+h,cssClass:"dialog",
innerCssClass:"dialog-inner",trigger:c});this.closeCallback=d;this.useAjaxLink=1;return this}ajaxPanel.prototype=new maxPanelCore;
function openPanel(b,c,d,e,h,f,g){var i="max_panel_"+b.getHashCode(),j=new maxPanel({id:i,w:e,h:h,trigger:c,position:f,cssClass:d,innerCssClass:"dropdownmenu",bodyCssClass:"clearfix dropdownmenu-inner"});j.closeCallback=g;d=j.panel.body;e=String.format('<iframe height="{1}" width="{0}" frameborder="0" scrolling="no"></iframe>',e-4,h-4);d.innerHTML=e;e=d.childNodes[0];h=e.contentDocument?e.contentDocument:e.contentWindow.document;h.open();h.write(String.format('<img src="{0}" alt=""  />\u6b63\u5728\u8f7d\u5165...',
max.consts.loading16));h.close();g=max.browser.isIE6;h=null;if(c){i=d=0;for(i=c.parentNode;i;){if(!d&&i.className&&i.className.indexOf("scroller")>-1){d=0-i.scrollTop;if(g)break}if(i.nodeName.indexOf("document")!=-1)break;var k=i.getAttribute("id");if(!g&&k&&k.indexOf("mx_dialog_")>-1){h=i;break}i=i.parentNode}g="absolute";if(h)g="fixed";j.panel.style.position=g;showPopup(j.panel,c,f,0,d)}else moveToCenter(j.panel);e.src=b;window.setTimeout(function(){j.focus()},20);return j}
var ajaxLayer=function(b,c,d,e){b="mx_layer_"+b.getHashCode();if(ajaxLayer.instance){var h=ajaxLayer.instance;h.panelID!=b&&h.close()}ajaxLayer._clickTrigger=1;maxPanel.call(this,{id:b,trigger:c,position:d,cssClass:e,innerCssClass:"dropdownmenu",bodyCssClass:"clearfix dropdownmenu-inner"});if(!ajaxLayer.inited){ajaxLayer.inited=1;ajaxLayer._clickTrigger=0;window.setTimeout(function(){addHandler(document.documentElement,"click",function(){if(!window.isClickDialog)if(ajaxLayer._clickPanel)ajaxLayer._clickPanel=
0;else if(ajaxLayer._clickTrigger)ajaxLayer._clickTrigger=0;else if(ajaxLayer.instance){try{ajaxLayer.instance.close()}catch(f){}ajaxLayer.instance=null}})},20)}if(max.browser.isIE6)if(this.panel.frame){removeElement(this.panel.frame);this.panel.frame=null}addHandler(this.panel,"click",function(){ajaxLayer._clickPanel=1});ajaxLayer.instance=this};ajaxLayer.prototype=new maxPanelCore;var topLayer=function(b,c,d,e){this.offsetLeft=15;this.position="right";ajaxLayer.call(this,b,c,d,e)};
topLayer.prototype=new maxPanelCore;function openTopbarLayer(b,c,d,e,h,f,g){d=d?"dropdownmenu-wrap "+d:"dropdownmenu-wrap";c=new topLayer(b,c,f,d);c.setContent('<div class="dropdownmenuloader"><span>\u6b63\u5728\u8f7d\u5165...</span></div>');c.hasContent=0;c.loadPage(b);c.focus();return false}
function openAjaxLayer(b,c,d,e,h,f,g){d=d?"dropdownmenu-wrap "+d:"dropdownmenu-wrap";c=new ajaxLayer(b,c,f,d);c.setContent('<div class="dropdownmenuloader"><span>\u6b63\u5728\u8f7d\u5165...</span></div>');c.hasContent=0;c.loadPage(b);c.focus();return false}
function openFriendList(b,c,d,e,h,f,g){e="mx_layer_"+b.getHashCode();d=d?"dropdownmenu-wrap "+d:"dropdownmenu-wrap";c=new maxPanel({id:e,trigger:c,position:f,cssClass:d,innerCssClass:"dropdownmenu",bodyCssClass:"clearfix dropdownmenu-inner"});max.browser.isIE6||setStyle(c.panel,{position:"fixed"});c.setContent('<div class="dropdownmenuloader"><span>\u6b63\u5728\u8f7d\u5165...</span></div>');c.hasContent=0;c.loadPage(b);c.focus();return false}
var DynamicTable=function(b,c){this.maxKey=1;var d=$$(c);if(d)for(c=0;c<d.length;c++)if(d[c].value!="{0}")if(parseInt(d[c].value)>=this.maxKey)this.maxKey=parseInt(d[c].value)+1;this.newRowId="newrow-{0}";this.deleteTrigger="deleteRow{0}";this.cellContentTemplates=[];this.table=$(b);this.body=null;b=this.table.getElementsByTagName("tbody");this.body=b.length?b[0]:this.table;this.tamplate="";for(c=0;c<this.body.rows.length;c++)if(this.body.rows[c].id=="newrow"){for(b=0;b<this.body.rows[c].cells.length;b++)this.cellContentTemplates.push({innerHTML:this.body.rows[c].cells[b].innerHTML,
style:this.body.rows[c].cells[b].style});break}removeElement($("newrow"))};
DynamicTable.prototype.insertRow=function(b){for(var c,d=this.body.insertRow(this.body.rows.length),e=0;e<this.cellContentTemplates.length;e++){c=d.insertCell(e);c.innerHTML=String.format(this.cellContentTemplates[e].innerHTML,this.maxKey);if(this.cellContentTemplates[e].style)for(var h in this.cellContentTemplates[e].style)try{c.style[h]=this.cellContentTemplates[e].style[h]}catch(f){}}d.id=String.format(this.newRowId,this.maxKey);var g=this,i=this.maxKey;addHandler($(String.format(this.deleteTrigger,
this.maxKey)),"click",function(){g.deleteRow(i)});b&&b(this.maxKey);this.maxKey++};DynamicTable.prototype.deleteRow=function(b){b=String.format(this.newRowId,b);removeElement($(b))};
function copyToClipboard(b){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",b)}else if(navigator.userAgent.indexOf("Opera")!=-1)window.location=b;else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){alert("\u88ab\u6d4f\u89c8\u5668\u62d2\u7edd\uff01\n\u8bf7\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165'about:config'\u5e76\u56de\u8f66\n\u7136\u540e\u5c06'signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3a'true'");return}var d=
Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d)return;var e=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!e)return;e.addDataFlavor("text/unicode");var h={};h={};h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);h.data=b;e.setTransferData("text/unicode",h,b.length*2);if(!d)return;d.setData(e,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}alert("\u590d\u5236\u6210\u529f\uff01")}
function initDatePicker(b,c){function d(){if(initDatePicker.inited)e();else{initDatePicker.inited=1;addHandler(document.documentElement,"mousedown",e)}var g=root+"/max-assets/javascript/datepicker.html?date="+h.value;window.setTimeout(function(){var i=openPanel(g,h,"",310,190,"auto",function(j){h.value=j});i.focus();window.datePanel=i},50)}function e(){window.datePanel&&window.datePanel.close();window.datePanel=null}var h,f;h=typeof b=="string"?$(b):b;if(c)f=$(c);if(!(h.readOnly||h.disabled)){addHandler(h,
"click",d);f&&addHandler(f,"click",d)}}
function initColorSelector(b,c){function d(i){if(f){var j;if(f&&f.childNodes&&f.childNodes.length>0)j=f.childNodes[0];if(j)j.style.backgroundColor=i}}function e(){if(initColorSelector.inited)h();else{initColorSelector.inited=1;addHandler(document.documentElement,"mousedown",h)}var i=g.value.replace("#","");if(i=="")i="ffffff";var j=root+"/max-assets/javascript/colorboard.html?color="+i;window.setTimeout(function(){window.colorPanel=openPanel(j,g,"",240,240,"auto",function(k){g.value=k;d(k)});window.colorPanel.focus()},
50)}function h(){window.colorPanel&&window.colorPanel.close();window.colorPanel=null}var f;if(c)f=$(c);var g=typeof b=="string"?$(b):b;b=g.value;if(b=="")b="ffffff";else{d(b);b=b.replace("#","")}b=parseInt(b,16);b=to16(16777215^b);if(!g.readOnly){g.readOnly=true;addHandler(g,"click",e);f&&addHandler(f,"click",e)}};
